function setPalette(cP)
{
  cP[0] = new Array();
  cP[1] = new Array();
  cP[2] = new Array();
  cP[3] = new Array();
  cP[4] = new Array();
  cP[0][0] = new Array();
  cP[0][1] = new Array();
  cP[1][0] = new Array();
  cP[1][1] = new Array();
  cP[2][0] = new Array();
  cP[2][1] = new Array();
  cP[3][0] = new Array();
  cP[3][1] = new Array();
  cP[4][0] = new Array();
  cP[4][1] = new Array();

  cP[0][0][0] ='rgb(  0,   0,   0)';//deadblack
  cP[0][0][1] ='rgb( 93,   0,   0)';//red
  cP[0][0][2] ='rgb( 89,  27,   0)';//orange
  cP[0][0][3] ='rgb( 95,  55,   0)';//gold
  cP[0][0][4] ='rgb( 82,  78,   0)';//yellow
  cP[0][0][5] ='rgb( 44,  82,   0)';//lime
  cP[0][0][6] ='rgb(  7,  85,   0)';//green
  cP[0][0][7] ='rgb(  0,  82,  31)';//sea
  cP[0][0][8] ='rgb(  0,  78,  69)';//cyan
  cP[0][0][9] ='rgb( 20,  48,  85)';//sky
  cP[0][0][10]='rgb( 31,  31,  89)';//blue
  cP[0][0][11]='rgb( 50,  23,  93)';//purple
  cP[0][0][12]='rgb( 82,   0,  74)';//magenta
  cP[0][0][13]='rgb( 89,   0,  39)';//hotpink
  cP[0][0][14]='rgb(115,  50,  60)';//pink
  cP[0][0][15]='rgb( 85,  45, 100)';//lilac
  cP[0][0][16]='rgb( 95,  45,  30)';//peach
  cP[0][0][17]='rgb(105,  65,  45)';//peachtint
  cP[0][0][18]='rgb( 85,  85,  45)';//yellowtint
  cP[0][0][19]='rgb( 54,  89,  66)';//greentint
  cP[0][0][20]='rgb( 60,  78,  89)';//bluetint
  cP[0][0][21]='rgb( 80,  70, 100)';//lilactint
  cP[0][0][22]='rgb(115,  80,  90)';//pinktint
  cP[0][0][23]='rgb( 74,  74,  74)';//white
  cP[0][0][24]='rgb( 35,  35,  35)';//gray
  cP[0][0][25]='rgb( 70,  46,  35)';//brown
  cP[0][0][26]='rgb(255, 255, 255)';//deadwhite
  cP[0][0][27]='rgb(255, 255, 255)';//whiteblack
  cP[0][1][0] ='rgb(  0,   0,   0)';
  cP[0][1][1] ='rgb(255, 160, 160)';
  cP[0][1][2] ='rgb(250, 180, 120)';
  cP[0][1][3] ='rgb(230, 175, 160)';
  cP[0][1][4] ='rgb(240, 230, 200)';
  cP[0][1][5] ='rgb(170, 210, 160)';
  cP[0][1][6] ='rgb(187, 218, 171)';
  cP[0][1][7] ='rgb(170, 240, 190)';
  cP[0][1][8] ='rgb(160, 215, 215)';
  cP[0][1][9] ='rgb(117, 171, 214)';
  cP[0][1][10]='rgb(160, 160, 255)';
  cP[0][1][11]='rgb(179, 140, 214)';
  cP[0][1][12]='rgb(230, 117, 210)';
  cP[0][1][13]='rgb(255, 120, 150)';
  cP[0][1][14]='rgb(250, 160, 170)';
  cP[0][1][15]='rgb(190, 140, 210)';
  cP[0][1][16]='rgb(195, 110,  80)';
  cP[0][1][17]='rgb(195, 110,  80)';
  cP[0][1][18]='rgb(170, 160, 120)';
  cP[0][1][19]='rgb(140, 210, 171)';
  cP[0][1][20]='rgb(135, 171, 210)';
  cP[0][1][21]='rgb(185, 151, 210)';
  cP[0][1][22]='rgb(200, 120, 120)';
  cP[0][1][23]='rgb(156, 156, 156)';
  cP[0][1][24]='rgb(175, 175, 175)';
  cP[0][1][25]='rgb(230, 170, 145)';
  cP[0][1][26]='rgb(255, 255, 255)';
  cP[0][1][27]='rgb(  0,   0,   0)';
  cP[1][0][0] ='rgb(  0,   0,   0)';
  cP[1][0][1] ='rgb(136,   0,   0)';
  cP[1][0][2] ='rgb(132,  39,   0)';
  cP[1][0][3] ='rgb(135,  78,   0)';
  cP[1][0][4] ='rgb(121, 117,   0)';
  cP[1][0][5] ='rgb( 66, 123,   0)';
  cP[1][0][6] ='rgb( 11, 128,   0)';
  cP[1][0][7] ='rgb(  0, 125,  50)';
  cP[1][0][8] ='rgb(  0, 102,  92)';
  cP[1][0][9] ='rgb( 31,  68, 125)';
  cP[1][0][10]='rgb( 39,  39, 132)';
  cP[1][0][11]='rgb( 75,  27, 132)';
  cP[1][0][12]='rgb(125,   0, 113)';
  cP[1][0][13]='rgb(128,   0,  54)';
  cP[1][0][14]='rgb(150,  65,  78)';
  cP[1][0][15]='rgb(110,  60, 140)';
  cP[1][0][16]='rgb(135,  70,  40)';
  cP[1][0][17]='rgb(142,  95,  65)';
  cP[1][0][18]='rgb(125, 125,  67)';
  cP[1][0][19]='rgb( 85, 132,  97)';
  cP[1][0][20]='rgb( 90, 113, 132)';
  cP[1][0][21]='rgb(115,  95, 140)';
  cP[1][0][22]='rgb(150, 105, 117)';
  cP[1][0][23]='rgb(101, 101, 101)';
  cP[1][0][24]='rgb( 46,  46,  46)';
  cP[1][0][25]='rgb( 89,  58,  42)';
  cP[1][0][26]='rgb(255, 255, 255)';
  cP[1][0][27]='rgb(255, 255, 255)';
  cP[1][1][0] ='rgb(  0,   0,   0)';
  cP[1][1][1] ='rgb(255, 120, 120)';
  cP[1][1][2] ='rgb(250, 160,  90)';
  cP[1][1][3] ='rgb(230, 175, 120)';
  cP[1][1][4] ='rgb(240, 230, 150)';
  cP[1][1][5] ='rgb(170, 210, 120)';
  cP[1][1][6] ='rgb(144, 210, 128)';
  cP[1][1][7] ='rgb(140, 230, 170)';
  cP[1][1][8] ='rgb(120, 208, 208)';
  cP[1][1][9] ='rgb( 93, 160, 214)';
  cP[1][1][10]='rgb(120, 120, 255)';
  cP[1][1][11]='rgb(164, 109, 214)';
  cP[1][1][12]='rgb(226,  93, 210)';
  cP[1][1][13]='rgb(255,  90, 140)';
  cP[1][1][14]='rgb(245, 150, 160)';
  cP[1][1][15]='rgb(180, 130, 200)';
  cP[1][1][16]='rgb(195, 110,  60)';
  cP[1][1][17]='rgb(195, 110,  60)';
  cP[1][1][18]='rgb(170, 160,  90)';
  cP[1][1][19]='rgb(105, 179, 128)';
  cP[1][1][20]='rgb(100, 128, 179)';
  cP[1][1][21]='rgb(160, 118, 180)';
  cP[1][1][22]='rgb(190,  90,  90)';
  cP[1][1][23]='rgb(117, 117, 117)';
  cP[1][1][24]='rgb(156, 156, 156)';
  cP[1][1][25]='rgb(208, 152, 125)';
  cP[1][1][26]='rgb(255, 255, 255)';
  cP[1][1][27]='rgb(  0,   0,   0)';
  cP[2][0][0] ='rgb(  0,   0,   0)';
  cP[2][0][1] ='rgb(187,   0,   0)';
  cP[2][0][2] ='rgb(179,  54,   0)';
  cP[2][0][3] ='rgb(175, 110,   0)';
  cP[2][0][4] ='rgb(171, 164,   0)';
  cP[2][0][5] ='rgb( 93, 171,   0)';
  cP[2][0][6] ='rgb( 15, 179,   0)';
  cP[2][0][7] ='rgb(  0, 171,  66)';
  cP[2][0][8] ='rgb(  0, 136, 123)';
  cP[2][0][9] ='rgb( 42,  92, 167)';
  cP[2][0][10]='rgb( 46,  46, 183)';
  cP[2][0][11]='rgb(100,  35, 175)';
  cP[2][0][12]='rgb(171,   0, 160)';
  cP[2][0][13]='rgb(175,   0,  70)';
  cP[2][0][14]='rgb(185,  80,  95)';
  cP[2][0][15]='rgb(135,  75, 180)';
  cP[2][0][16]='rgb(175,  95,  50)';
  cP[2][0][17]='rgb(180, 125,  85)';
  cP[2][0][18]='rgb(168, 168,  90)';
  cP[2][0][19]='rgb(117, 187, 140)';
  cP[2][0][20]='rgb(120, 140, 183)';
  cP[2][0][21]='rgb(158, 120, 180)';
  cP[2][0][22]='rgb(185, 130, 145)';
  cP[2][0][23]='rgb(164, 164, 164)';
  cP[2][0][24]='rgb( 66,  66,  66)';
  cP[2][0][25]='rgb(117,  74,  58)';
  cP[2][0][26]='rgb(255, 255, 255)';
  cP[2][0][27]='rgb(255, 255, 255)';
  cP[2][1][0] ='rgb(  0,   0,   0)';
  cP[2][1][1] ='rgb(255,  80,  80)';
  cP[2][1][2] ='rgb(250, 140,  60)';
  cP[2][1][3] ='rgb(230, 175,  80)';
  cP[2][1][4] ='rgb(240, 230, 100)';
  cP[2][1][5] ='rgb(170, 210,  80)';
  cP[2][1][6] ='rgb(101, 203,  85)';
  cP[2][1][7] ='rgb(110, 220, 150)';
  cP[2][1][8] ='rgb( 80, 200, 200)';
  cP[2][1][9] ='rgb( 70, 148, 214)';
  cP[2][1][10]='rgb( 80,  80, 255)';
  cP[2][1][11]='rgb(148,  82, 214)';
  cP[2][1][12]='rgb(222,  70, 207)';
  cP[2][1][13]='rgb(255,  60, 130)';
  cP[2][1][14]='rgb(240, 140, 150)';
  cP[2][1][15]='rgb(170, 120, 190)';
  cP[2][1][16]='rgb(195, 110,  40)';
  cP[2][1][17]='rgb(195, 110,  40)';
  cP[2][1][18]='rgb(170, 160,  60)';
  cP[2][1][19]='rgb( 70, 148,  85)';
  cP[2][1][20]='rgb( 75,  85, 148)';
  cP[2][1][21]='rgb(135,  85, 150)';
  cP[2][1][22]='rgb(180,  60,  60)';
  cP[2][1][23]='rgb( 78,  78,  78)';
  cP[2][1][24]='rgb(136, 136, 136)';
  cP[2][1][25]='rgb(185, 133, 106)';
  cP[2][1][26]='rgb(255, 255, 255)';
  cP[2][1][27]='rgb(  0,   0,   0)';
  cP[3][0][0] ='rgb(  0,   0,   0)';
  cP[3][0][1] ='rgb(230,   0,   0)';
  cP[3][0][2] ='rgb(226,  74,   0)';
  cP[3][0][3] ='rgb(215, 137,   0)';
  cP[3][0][4] ='rgb(218, 210,   0)';
  cP[3][0][5] ='rgb(117, 216,   0)';
  cP[3][0][6] ='rgb( 19, 222,   0)';
  cP[3][0][7] ='rgb(  0, 214,  85)';
  cP[3][0][8] ='rgb(  0, 171, 154)';
  cP[3][0][9] ='rgb( 54, 120, 222)';
  cP[3][0][10]='rgb( 54,  54, 226)';
  cP[3][0][11]='rgb(125,  42, 222)';
  cP[3][0][12]='rgb(218,   0, 203)';
  cP[3][0][13]='rgb(222,   0,  85)';
  cP[3][0][14]='rgb(220,  95, 112)';
  cP[3][0][15]='rgb(160,  90, 220)';
  cP[3][0][16]='rgb(215, 120,  60)';
  cP[3][0][17]='rgb(217, 155, 105)';
  cP[3][0][18]='rgb(210, 210, 112)';
  cP[3][0][19]='rgb(140, 230, 164)';
  cP[3][0][20]='rgb(142, 162, 226)';
  cP[3][0][21]='rgb(185, 145, 220)';
  cP[3][0][22]='rgb(220, 155, 172)';
  cP[3][0][23]='rgb(214, 214, 214)';
  cP[3][0][24]='rgb( 93,  93,  93)';
  cP[3][0][25]='rgb(140,  93,  70)';
  cP[3][0][26]='rgb(255, 255, 255)';
  cP[3][0][27]='rgb(255, 255, 255)';
  cP[3][1][0] ='rgb(  0,   0,   0)';
  cP[3][1][1] ='rgb(255,  40,  40)';
  cP[3][1][2] ='rgb(250, 120,  30)';
  cP[3][1][3] ='rgb(230, 175,  40)';
  cP[3][1][4] ='rgb(240, 230,  50)';
  cP[3][1][5] ='rgb(170, 210,  40)';
  cP[3][1][6] ='rgb( 58, 195,  42)';
  cP[3][1][7] ='rgb( 80, 210, 130)';
  cP[3][1][8] ='rgb( 40, 192, 192)';
  cP[3][1][9] ='rgb( 46, 132, 214)';
  cP[3][1][10]='rgb( 40,  40, 255)';
  cP[3][1][11]='rgb(132,  54, 214)';
  cP[3][1][12]='rgb(218,  42, 207)';
  cP[3][1][13]='rgb(255,  30, 120)';
  cP[3][1][14]='rgb(235, 130, 140)';
  cP[3][1][15]='rgb(160, 110, 180)';
  cP[3][1][16]='rgb(195, 110,  20)';
  cP[3][1][17]='rgb(195, 110,  20)';
  cP[3][1][18]='rgb(170, 160,  30)';
  cP[3][1][19]='rgb( 39, 121,  42)';
  cP[3][1][20]='rgb( 45,  42, 122)';
  cP[3][1][21]='rgb(118,  42, 125)';
  cP[3][1][22]='rgb(170,  30,  30)';
  cP[3][1][23]='rgb( 39,  39,  39)';
  cP[3][1][24]='rgb(117, 117, 117)';
  cP[3][1][25]='rgb(163, 114,  88)';
  cP[3][1][26]='rgb(255, 255, 255)';
  cP[3][1][27]='rgb(  0,   0,   0)';
  cP[4][0][0] ='rgb(  0,   0,   0)';
  cP[4][0][1] ='rgb(255,   0,   0)';
  cP[4][0][2] ='rgb(255,  93,   0)';
  cP[4][0][3] ='rgb(255, 165,   0)';
  cP[4][0][4] ='rgb(255, 246,   0)';
  cP[4][0][5] ='rgb(140, 251,   0)';
  cP[4][0][6] ='rgb( 23, 255,   0)';
  cP[4][0][7] ='rgb(  0, 250, 109)';
  cP[4][0][8] ='rgb(  0, 205, 185)';
  cP[4][0][9] ='rgb( 64, 149, 255)';
  cP[4][0][10]='rgb( 62,  62, 255)';
  cP[4][0][11]='rgb(150,  54, 255)';
  cP[4][0][12]='rgb(255,   0, 234)';
  cP[4][0][13]='rgb(255,   0, 101)';
  cP[4][0][14]='rgb(255, 110, 130)';
  cP[4][0][15]='rgb(185, 105, 255)';
  cP[4][0][16]='rgb(255, 140,  60)';
  cP[4][0][17]='rgb(255, 185, 125)';
  cP[4][0][18]='rgb(250, 250, 135)';
  cP[4][0][19]='rgb(152, 255, 179)';
  cP[4][0][20]='rgb(160, 180, 255)';
  cP[4][0][21]='rgb(220, 170, 255)';
  cP[4][0][22]='rgb(255, 180, 200)';
  cP[4][0][23]='rgb(255, 255, 255)';
  cP[4][0][24]='rgb(125, 125, 125)';
  cP[4][0][25]='rgb(175, 117,  89)';
  cP[4][0][26]='rgb(255, 255, 255)';
  cP[4][0][27]='rgb(255, 255, 255)';
  cP[4][1][0] ='rgb(  0,   0,   0)';
  cP[4][1][1] ='rgb(255,   0,   0)';
  cP[4][1][2] ='rgb(250, 100,   0)';
  cP[4][1][3] ='rgb(230, 175,   0)';
  cP[4][1][4] ='rgb(240, 230,   0)';
  cP[4][1][5] ='rgb(170, 210,   0)';
  cP[4][1][6] ='rgb( 15, 187,   0)';
  cP[4][1][7] ='rgb( 50, 200, 110)';
  cP[4][1][8] ='rgb(  0, 185, 185)';
  cP[4][1][9] ='rgb( 19, 117, 214)';
  cP[4][1][10]='rgb(  0,   0, 255)';
  cP[4][1][11]='rgb(117,  19, 214)';
  cP[4][1][12]='rgb(214,   0, 207)';
  cP[4][1][13]='rgb(255,   0, 110)';
  cP[4][1][14]='rgb(230, 120, 130)';
  cP[4][1][15]='rgb(150, 100, 170)';
  cP[4][1][16]='rgb(195, 110,   0)';
  cP[4][1][17]='rgb(195, 110,   0)';
  cP[4][1][18]='rgb(170, 160,   0)';
  cP[4][1][19]='rgb(  7,  93,  15)';
  cP[4][1][20]='rgb( 15,  20, 110)';
  cP[4][1][21]='rgb(100,  15, 110)';
  cP[4][1][22]='rgb(160,   0,   0)';
  cP[4][1][23]='rgb(  0,   0,   0)';
  cP[4][1][24]='rgb( 97,  97,  97)';
  cP[4][1][25]='rgb(142,  95,  70)';
  cP[4][1][26]='rgb(255, 255, 255)';
  cP[4][1][27]='rgb(  0,   0,   0)';
}

function numberofcolor(c)
{
 var ireturn = 23;
 if     (!c.localeCompare("red"       ) ) { ireturn= 1;}
 else if(!c.localeCompare("orange"    ) ) { ireturn= 2;}
 else if(!c.localeCompare("rust"      ) ) { ireturn= 2;}
 else if(!c.localeCompare("gold"      ) ) { ireturn= 3;}
 else if(!c.localeCompare("yellow"    ) ) { ireturn= 4;}
 else if(!c.localeCompare("lime"      ) ) { ireturn= 5;}
 else if(!c.localeCompare("green"     ) ) { ireturn= 6;}
 else if(!c.localeCompare("sea"       ) ) { ireturn= 7;}
 else if(!c.localeCompare("seagreen"  ) ) { ireturn= 7;}
 else if(!c.localeCompare("cyan"      ) ) { ireturn= 8;}
 else if(!c.localeCompare("sky"       ) ) { ireturn= 9;}
 else if(!c.localeCompare("skyblue"   ) ) { ireturn= 9;}
 else if(!c.localeCompare("blue"      ) ) { ireturn=10;}
 else if(!c.localeCompare("purple"    ) ) { ireturn=11;}
 else if(!c.localeCompare("magenta"   ) ) { ireturn=12;}
 else if(!c.localeCompare("hotpink"   ) ) { ireturn=13;}
 
 else if(!c.localeCompare("pink"      ) ) { ireturn=14;}
 else if(!c.localeCompare("lilac"     ) ) { ireturn=15;}
 else if(!c.localeCompare("peach"     ) ) { ireturn=16;}

 else if(!c.localeCompare("peachtint" ) ) { ireturn=17;}
 else if(!c.localeCompare("paleyellow") ) { ireturn=18;}
 else if(!c.localeCompare("yellowtint") ) { ireturn=18;}
 else if(!c.localeCompare("greentint" ) ) { ireturn=19;}
 else if(!c.localeCompare("bluetint"  ) ) { ireturn=20;}
 else if(!c.localeCompare("lilactint" ) ) { ireturn=21;}
 else if(!c.localeCompare("pinktint"  ) ) { ireturn=22;}
 
 else if(!c.localeCompare("white"     ) ) { ireturn=23;} 
 else if(!c.localeCompare("default"   ) ) { ireturn=23;}
 else if(!c.localeCompare("gray"      ) ) { ireturn=24;}
 else if(!c.localeCompare("grey"      ) ) { ireturn=24;}
 else if(!c.localeCompare("brown"     ) ) { ireturn=25;}
 
 else if(!c.localeCompare("invisible" ) ) { ireturn=31;}
 
 else if(!c.localeCompare("deadwhite" ) ) { ireturn=29;}
 else if(!c.localeCompare("black"     ) ) { ireturn=30;}
 else if(!c.localeCompare("deadblack" ) ) { ireturn=30;}
 else { ireturn= 23;}

 return(ireturn);
}

function retrievecolordepth( tri )
{
 var ideep;
 var bulb = new Array();
 bulb[0] = 1;
 bulb[1] = -0.5;
 bulb[2] = -0.5;
 bulb[3] = 1.0;
 bulb = normalizevector( bulb ); 
 var ab = new Array();
 ab[0] = 1;
 ab[1] = tri[1] - tri[4];
 ab[2] = tri[2] - tri[5];
 ab[3] = tri[3] - tri[6];
 var cb = new Array();
 cb[0] = 1;
 cb[1] = tri[7] - tri[4];
 cb[2] = tri[8] - tri[5];
 cb[3] = tri[9] - tri[6];

 ab = normalizevector(ab);
 cb = normalizevector(cb);
 if(ab[0] && cb[0])
 {
   var d = new Array();

   d[0] = 0;
   d[1] = 0;
   d[2] = 0;
   d[3] = 0;
   d = xproduct(ab, cb);
   d = normalizevector(d);
   /*normal vector of triangle*/
   /*bulb[] lighting-vector */
   var dotang = d[1]*bulb[1] + d[2]*bulb[2] + d[3]*bulb[3];
   if(BW == 1)
   {/*WHITE background*/
     if(  dotang < -0.85 || dotang > 0.85 ) /*95toward light*/
     { ideep = 1; }
     else if(  dotang < -0.70 || dotang > 0.70 ) /*80sort of toward light*/
     { ideep = 2; }
     else if(  dotang < -0.60 || dotang > 0.60 ) /*60side to light*/
     { ideep = 3; }
     else/*back from light*/
     { ideep = 4; }
   }
   else
   {/*BLACK background*/
     if(  dotang < -0.85 || dotang > 0.85 ) /*toward light*/
     { ideep = 4;}
     else if(  dotang < -0.70 || dotang > 0.70 ) /*sort of toward light*/
     { ideep = 3; }
     else if(  dotang < -0.60 || dotang > 0.60 ) /*side to light*/
     { ideep = 2; }
     else /*back from light*/
     { ideep = 1;}
   }
 }
 else
 {
    ideep = 0;
 }
 return(ideep);
}

function normalizevector(a)
{

  var mag;
  mag = Math.sqrt(a[1]*a[1] + a[2]*a[2] + a[3]*a[3]);

  if(mag > 0.001)
  {
     a[0] = 1;
     a[1] = a[1]/mag;
     a[2] = a[2]/mag;
     a[3] = a[3]/mag;
  }
  else
  {
     a[0] = 0;
  }
  return(a);

}

function xproduct(a, b)
{
   var g = new Array();
   g[0] = 1;
   g[1] = (a[2])*(b[3]) - (a[3])*(b[2]);
   g[2] = (a[3])*(b[1]) - (a[1])*(b[3]);
   g[3] = (a[1])*(b[2]) - (a[2])*(b[1]);
   return(g);
}